# Network Interpreter
### Shea Clark-Tieche, Siddhartha Prasad, and Nikhil Shinday

*uScheme* is a language detailed in the book *Programming Languages: an
Interpreter-Based Approach* by Ramsey and Kamin. This repository/directory
contains a *uScheme* interpreter that can be used by several clients across
a network. All clients share an environment, and need to be connected to the
parent server to access it. A graceful exit runs the interpreter locally with
the shared environment.

While this program uses a *uScheme* interpreter, and has some language specific
features, the server and client are interpreter agnostic in a general sense.

## Usage

### Compile and Run

    /bin/bash ni_compile <args>: 
	<args>: option 1: -c : just compile
		option 2: <hostname> <port> : will run both server and client
		option 3: <nil> : just run on localhost

    to run file transfer macro test: 
    /bin/bash file_transfer/ftcompile <args>: 
	<args>: option 1: <hostname> <port> : runs both server and client, transfers 
					binary and logfile to client, forks and runs
		option 2: <nil> : just run on localhost	

### Compile Client

    ./ni_compile -c
    
    or

    gcc -g iclient.c -o ni_client -lnsl -pthread

    To run client: 
    ./ni_client <hostname> <portnumber>


The command  `(exit)` can be used to transfer from a network to local interpreter.

### Server
    ./ni_compile -c 

    or 

    gcc -g iserv.c -o ni_server -lnsl

    To run server: 
    ./server <portnumber>

## Future Plans

- Setting permission levels -- clients who can change the environment vs those
who can only access it.
- Implementing a graceful transfer to a local interpreter on unplanned disconnection.


#Implementation

## Current Protocol

When the server communicates with the client (and vice versa), we have the
following basic protocol.

Message Type   | From  | To   | Meaning|
---------------|-------|------|--------
1              |Client |Server|Request to connect|
2              |Server |Client|Update to environment|
3              |Client |Server|Interpreter command|
4              |Server |Client|Interpreter command ACK |
5              |Client |Server|Graceful exit|
6              |Server |Client| Interpreter file transfer|
7              |Server |Client| logfile transfer|
8              |Server |Client| Accepted connection|





## Reserved Filenames

- The files *logfile.scm* and *intermediate* are generated by the server.
No files with these names should be in the same directory as the server.

- On the client-side, the file names *uscheme1* and *logfile.scm* are reserved.


## Client

- The current client is multi-threaded, reading from and writing to the
server concurrently. 

- A graceful exit provides the user with a copy of the interpreter as
well as a log with all the commands provided to the interpreter.
This is used to create an offline interpreter with the
same current environment.

## Server

- The server uses the `select` function to queue incoming interpreter results,
giving precedence to clients who connected earlier. 

- The server is concurrent, using two processes. One runs a *uScheme*
interpreter while the other interacts with clients.



## Applications

- Education

- Job Interviews

- Problem Solving 

- General collaboration

- !! FUN !! 

